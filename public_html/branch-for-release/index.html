<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="ru-ru">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Ветка для релиза - Trunk Based Development</title>
    <meta name="generator" content="Hugo 0.74.3" />

    
    <meta name="description" content="A portal on this practice">
    
    <link rel="canonical" href="https://trunkbaseddevelopment.ru/branch-for-release/">
    
    <meta name="author" content="paul-hammant">
    

    <meta property="og:url" content="https://trunkbaseddevelopment.ru/branch-for-release/">
    <meta property="og:title" content="Trunk Based Development">
    <meta property="og:image" content="https://trunkbaseddevelopment.ru/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Trunk Based Development">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://trunkbaseddevelopment.ru/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://trunkbaseddevelopment.ru/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://trunkbaseddevelopment.ru/fonts/icon.eot');
        src: url('https://trunkbaseddevelopment.ru/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://trunkbaseddevelopment.ru/fonts/icon.woff')
               format('woff'),
             url('https://trunkbaseddevelopment.ru/fonts/icon.ttf')
               format('truetype'),
             url('https://trunkbaseddevelopment.ru/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/application.css">
    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://trunkbaseddevelopment.ru/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-light-blue">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Trunk Based Development: Ветка для релиза
      </div>
    </div>

    

        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <div class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://trunkbaseddevelopment.ru/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Trunk Based Development</strong>
      </div>
    </div>
  </div>

  <div class="scrollable">
    <div class="wrapper">
      <hr>

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Введение" href="https://trunkbaseddevelopment.ru/">
	
	Введение
</a>



  
</li>



<li>
  
    



<a  title="Контекст" href="https://trunkbaseddevelopment.ru/context/">
	
	Контекст
</a>



  
</li>



<li>
  
    



<a  title="Краткий обзор" href="https://trunkbaseddevelopment.ru/5-min-overview/">
	
	Краткий обзор
</a>



  
</li>



<li>
  
    



<a  title="Определяющие факторы" href="https://trunkbaseddevelopment.ru/deciding-factors/">
	
	Определяющие факторы
</a>



  
</li>



<li>
  
    



<a  title="Функции системы контроля версий" href="https://trunkbaseddevelopment.ru/vcs-features/">
	
	Функции системы контроля версий
</a>



  
</li>



<li>
  
    



<a  title="Version control system choices" href="https://trunkbaseddevelopment.ru/vcs-choices/">
	
	Version control system choices
</a>



  
</li>



<li>
  
    



<a  title="Флаги для функций" href="https://trunkbaseddevelopment.ru/feature-flags/">
	
	Флаги для функций
</a>



  
</li>



<li>
  
    



<a  title="Ветвление по абстракции" href="https://trunkbaseddevelopment.ru/branch-by-abstraction/">
	
	Ветвление по абстракции
</a>



  
</li>



<li>
  
    



<a class="current" title="Ветка для релиза" href="https://trunkbaseddevelopment.ru/branch-for-release/">
	
	Ветка для релиза
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Релиз из ветки trunk" href="https://trunkbaseddevelopment.ru/release-from-trunk/">
	
	Релиз из ветки trunk
</a>



  
</li>



<li>
  
    



<a  title="Styles and Trade-offs" href="https://trunkbaseddevelopment.ru/styles/">
	
	Styles and Trade-offs
</a>



  
</li>



<li>
  
    



<a  title="Continuous Integration (CI)" href="https://trunkbaseddevelopment.ru/continuous-integration/">
	
	Continuous Integration (CI)
</a>



  
</li>



<li>
  
    



<a  title="Вливание кода напрямую в trunk" href="https://trunkbaseddevelopment.ru/committing-straight-to-the-trunk/">
	
	Вливание кода напрямую в trunk
</a>



  
</li>



<li>
  
    



<a  title="Short Lived Feature Branches" href="https://trunkbaseddevelopment.ru/short-lived-feature-branches/">
	
	Short Lived Feature Branches
</a>



  
</li>



<li>
  
    



<a  title="Continuous Code Review" href="https://trunkbaseddevelopment.ru/continuous-review/">
	
	Continuous Code Review
</a>



  
</li>



<li>
  
    



<a  title="Continuous Delivery (CD)" href="https://trunkbaseddevelopment.ru/continuous-delivery/">
	
	Continuous Delivery (CD)
</a>



  
</li>



<li>
  
    



<a  title="Concurrent development of consecutive releases" href="https://trunkbaseddevelopment.ru/concurrent-development-of-consecutive-releases/">
	
	Concurrent development of consecutive releases
</a>



  
</li>



<li>
  
    



<a  title="Application strangulation" href="https://trunkbaseddevelopment.ru/strangulation/">
	
	Application strangulation
</a>



  
</li>



<li>
  
    



<a  title="Observed habits" href="https://trunkbaseddevelopment.ru/observed-habits/">
	
	Observed habits
</a>



  
</li>



<li>
  
    



<a  title="You&#39;re doing it wrong" href="https://trunkbaseddevelopment.ru/youre-doing-it-wrong/">
	
	You&#39;re doing it wrong
</a>



  
</li>



<li>
  
    



<a  title="Alternative branching models" href="https://trunkbaseddevelopment.ru/alternative-branching-models/">
	
	Alternative branching models
</a>



  
</li>



<li>
  
    



<a  title="Monorepos" href="https://trunkbaseddevelopment.ru/monorepos/">
	
	Monorepos
</a>



  
</li>



<li>
  
    



<a  title="Expanding Contracting Monorepos" href="https://trunkbaseddevelopment.ru/expanding-contracting-monorepos/">
	
	Expanding Contracting Monorepos
</a>



  
</li>



<li>
  
    



<a  title="Game Changers" href="https://trunkbaseddevelopment.ru/game-changers/">
	
	Game Changers
</a>



  
</li>



<li>
  
    



<a  title="Publications" href="https://trunkbaseddevelopment.ru/publications/">
	
	Publications
</a>



  
</li>



<li>
  
    



<a  title="Book on this topic" href="https://trunkbaseddevelopment.ru/book/">
	
	Book on this topic
</a>



  
</li>



<li>
  
    



<a  title="Key to branch diagrams" href="https://trunkbaseddevelopment.ru/key/">
	
	Key to branch diagrams
</a>



  
</li>



<li>
  
    



<a  title="Contributions" href="https://trunkbaseddevelopment.ru/contributions/">
	
	Contributions
</a>



  
</li>


        </ul>
        

        
        <hr>

        <ul>

          <li>
            <a href="https://github.com/paul-hammant/tbd" target="_blank" title="See GitHub Repo">
              Site Source on Github
            </a>
          </li>

          <li>
            <a href="https://github.com/paul-hammant/tbd/commit/" target="_blank">
              SHA-1 Published: 
            </a>
          </li>
          </li>
<iframe id="buy" width='160' height='400' src='https://leanpub.com/trunk-based-development/embed' frameborder='0' allowtransparency='true'></iframe>
          <li>
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1 style="color: white; padding: 32px 20px 72px; background-image:url(/public_html/images/LogoSlim.png); background-repeat: no-repeat; background-size: 100% auto"><span style="background-color: #5677fc">Ветка для релиза </span></h1>

			<div class="admonition quote">
<p class="admonition-title">Ветка: только когда необходимо, в случае несовместимой политики, как можно ближе к релизу, и вместо остановки работы</p>
<span style="padding-left: 15px"><!-- raw HTML omitted -->— Laura Wingerd &amp; Christopher Seiwald<!-- raw HTML omitted --><!-- raw HTML omitted -->
<!-- raw HTML omitted -->(1998&rsquo;s High-Level SCM Best Practices white paper from Perforce)<!-- raw HTML omitted --></span>
</div>
<br/>
<p>Если команда выпускает релизы в свет каждый месяц, то у этой команды также есть промежуточные релизы с исправленными ошибками между плановыми релизами раз в месяц.
Чтобы было легче, в командах, которые работают по Trunk-Based Development, создают релизную ветку почти перед релизом - например, за несколько дней до него.
Эта ветка становится таким местом, где все стабильно, при условии что разработчики продолжают работать в полную силу и отправляют свой код в trunk.</p>
<p>Несовместимая политика (отсылка к цитате выше) - это когда в релизную ветку &ldquo;не должен отправляться код, который пишется после ответвления от trunk&rdquo;.</p>
<p><img src="branch_for_release.png" alt="">
(<a href="https://trunkbaseddevelopment.ru/key/">key</a>)</p>
<p>^ Trunk, две с половиной релизные ветки, пять релизов (два запланированных, три незапланированных), и 2 исправления бага через cherry-pick</p>
<div class="admonition note">
<p class="admonition-title">CD команды не делают релизные ветки</p>
<span>Команды с высокой пропускной способностью и <a href="https://trunkbaseddevelopment.ru/continuous-delivery/">Continuous Delivery</a> могут это проигнорировать - если у них произошла неприятность
при выкладке кода в бой, то они выбирают стратегию roll-forward для того чтобы поправить это.
Roll-forward это такая стратегия, при которой баг исправляется в trunk и код выкатывается в бой также из trunk.</span>
</div>
<h2 id="кто-и-куда-отправляет-код">Кто и куда отправляет код?</h2>
<p>Разработчики с высокой пропускной способностью отправляют свой код в trunk (зеленые точки), и не замедляются или останавливают свою работу перед отведением
ветки или непосредственной близостью к релизу. Разработчики как группа <strong>не</strong> отправляют свой код в релизную ветку (см.ниже).</p>
<p><img src="branch_for_release2.png" alt="">
(<a href="https://trunkbaseddevelopment.ru/key/">key</a>)</p>
<p>Сама обрезка ветки является коммитом. Технически Subversion и Perforce будут иметь здесь более крупный коммит, но все системы VCS, используемые сегодня, будут считать коммит «легким» с точки зрения его влияния на историю/хранилище и времени, затрачиваемого на создание.</p>
<p>Эта красная точка - случайный сбой сборки, который (каким-то образом) был исправлен какое-то время спустя.</p>
<h2 id="позднее-создание-релизных-веток">Позднее создание релизных веток</h2>
<p>Некоторые команды <a href="https://trunkbaseddevelopment.ru/release-from-trunk/">делают релиз из тега в trunk</a> и не создают релизную ветку для этого.
Это само по себе является <strong>альтернативной практикой для &ldquo;ветки для релиза&rdquo;</strong>.</p>
<p>Эти команды ждут ошибку, которую необходимо исправить для релиза, прежде чем создавать ветку из тега релиза
(если они не собираются просто выпустить еще один выпуск из основной ветки).</p>
<p>Брэд Эпплтон (Brad Appleton) отмечает, что многие не понимают, что ветви можно создавать <strong>задним числом</strong>.
Это может использоваться в случае ошибок после «релиза из тега» или даже после изменений для мини-релизов.</p>
<h2 id="исправление-в-trunk-ошибок-найденных-в-бою">Исправление в trunk ошибок, найденных в бою</h2>
<p>Лушчая практика для команды, которая работает по Trunk-Based Development, это воспроизвести ошибку в trunk, поправить ее там же вместе с тестом,
проверить что CI сервер это подтвердит, затем сделать cherry-pick этого кода в релизную ветку и подождать пока CI сервер проверит релизную ветку
и подтвердит что с релизной веткой после cherry-pick все в порядке. Да, сборка на CI, которая защищает trunk, должна быть продублирована
и должна защищать активные релизные ветки так же, как и trunk.</p>
<div class="admonition warning">
<p class="admonition-title">Cherry-pick это не обычный merge</p>
<span>Cherry-pick это merge, который забирает только один конкретный коммит (или несколько коммитов) и вливает их в выбранную вами ветку.
Он не учитывает код, которые был написан до этого коммита, а учитывает только тот код, который был написан на момент отведения ветки.
Все системы контроля версий отслеживают то, какие коммиты были добавлены, а какие нет, так что вы можете сделать сколько угодно cherry-pick позже.</span>
</div>
<br/>
<h3 id="cherry-picks-только-из-trunk-в-релизную-ветку">Cherry-picks ТОЛЬКО из trunk в релизную ветку</h3>
<p>Вам не следует править ошибки в релизной ветке, полагая что потом вы сделаете cherry-pick обратно в trunk.
Почему? Ну, может случиться такое что вы забудете это сделать в очень неподходящий момент.
Такая забывчивость иногда может означать ухудшение работы кода в боевом окружении спустя несколько недель (и кого-то за это даже увольняют).
Это может произойти если ошибка исправлялась уставшим разработчиком в ночи, который хотел обратно в постель спать.</p>
<p><img src="branch_for_release3.png" alt="">
(<a href="https://trunkbaseddevelopment.ru/key/">key</a>)</p>
<p>Для команд, которые работают по Trunk Based Development, это правило все еще плохо соблюдается или соблюдается с неохотой, даже если команда практикует
все остальное, что связано с Trunk Based Development. Однако, достаточно всего одного неприятного случая для того, чтобы команда изменила свое отношение к этому.</p>
<p>Конечно, иногда вы <strong>совсем не можете</strong> воспроизвести ошибку в trunk. В этом случае вы должны сделать это наоборот, несмотря на все вышесказанное,
но вы должны понимать, что таким образом ваш код рискует стать хуже.</p>
<h3 id="рэйчел-потвин-rachel-potvin-из-google-о-cherry-picks">Рэйчел Потвин (Rachel Potvin) из Google о Cherry Picks</h3>
<p>В ходе выступления на конференции @Scale в сентябре 2015 г. «Почему Google хранит миллиарды строк кода в едином репозитории» был представлен слайд,
на котором показан cherry-pick на диаграмме ветвления:</p>
<p><img src="atscale.png" alt=""></p>
<p>Докладчик, Рэйчел Потвин (Rachel Potvin), сказала (на 14 минуте):</p>
<p>&ldquo;Итак, в Google у нас есть то, что называется Trunk-Based Development. Я должна отметить, что это сочетание разработки на основе магистралей с централизованным репозиторием, которое определяет монолитную модель управления исходным кодом. Итак, Trunk-Based Development для нас означает то,
что обычно все пользователи Piper работают с HEAD или с одной копей самой последней версии кодовой базы. Когда разработчики делают коммиты в Piper, их изменения сразу видны и могут использоваться другими разработчиками. Создание веток для разработки в Google происходит крайне редко и Trunk-Based Development отчасти способствует этому, потому что у вас нет неприятных слияний из-за того, что вам нужно отправить код из долгоживущей ветки в trunk. Однако, ветки используются для релиза. <strong>В общем, обычно релизная ветка это слепок ветки trunk с каким-то количеством cherry-picks, которые были сделаны из trunk в релизную ветку</strong>.&rdquo;</p>
<p>Мы сами решили выделить cherry-pick жирным шрифтом. Внимательные читатели заметят, что Рэйчел ссылается на другие ветки разработки, кроме trunk, по «редким» причинам. Мы можем включить наглость и предложить Google узнать немного больше о <a href="https://trunkbaseddevelopment.ru/branch-by-abstraction/">ветвлении по абстракции</a>.</p>
<h3 id="роль-подтверждающий-вливание-кода">Роль &ldquo;подтверждающий вливание кода&rdquo;</h3>
<p>Процесс вливания коммитов из trunk в релизнукю ветку выпуска с использованием «cherry pick» - это роль одного разработчика в команде. Или пара разработчиков, если вы занимаетесь экстремальным программированием. Даже в этом случае, это частичная занятость. Разработчику или паре, вероятно, необходимо составить список правил, прежде чем делать cherry pick. Правила вроде того, какой представитель бизнеса дает добро на вливание кода. Возможно, такая роль должна меняться каждый день.</p>
<p>Некоторые команды обновляют wiki для того, чтобы проверить что именно попало в релизную ветку после её отведения от trunk,
а какие-то команды используют систему тикетов, поскольку они по своей природе прерывают процесс и требуют подпись (след, отпечаток) у тех, кто подтверждает вливание кода.</p>
<h2 id="релиз-патча">Релиз патча</h2>
<p>Может такое случиться, что ваша команда выпустила релиз из релизной ветки, и теперь должна поправить ошибку, которая попала в продакшен. Если релизный цикл позволяет, то можно сделать cherry-pick исправленной ошибки из trunk в релизную ветку и из этой же ветки выпустить релиз.</p>
<h3 id="тег-вместо-ветки">Тег вместо ветки</h3>
<p>Если есть возможность выпускать релиз из тега в trunk, то лучше делать именно так, т.к. для большинства команд это будет серьезной оптимизацией. Тег должен соответствовать номеру релиза (например, v1.1.1) и тогда дополнительные ветки не нужны будут вообще. Если в продакшене появилась какая-то ошибка и релизная ветка ранее была создана из тега, то релиз патча можно делать из релизной ветки.</p>
<h2 id="удаление-релизной-ветки">Удаление релизной ветки</h2>
<p>Релизные ветки удаляются через какое-то время после завершения релизного процесса. Удаляются не моментально, а когда точно становится ясно что релиз завершен и работы по нему больше не ведутся. Релизные ветки НЕ вливаются обратно в trunk.
Обычно релизную ветку удаляют когда последующий релиз успешно выпущен.  Это безобидная операция по наведению порядка - ветки могут быть достаточно легко восстановлены во всех системах контроля версий. В git перед удалением ветки релиза необходимо создать тег из выпущенного коммита, поскольку болтающиеся без дела коммиты будут отправлены в мусорку.</p>
<h1 id="внешние-ссылки">Внешние ссылки</h1>
<p><!-- raw HTML omitted -->show references<!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->


			<aside class="copyright" role="note">
				&copy; 2017-2020: <a href="https://devops.paulhammant.com/">Paul Hammant</a>. With Contributions <a href="https://trunkbaseddevelopment.ru/contributions/">from friends</a>.
				Site built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				with
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme,
				via <a href="https://netlify.com/">Netlify</a>. &nbsp;
				<a href="https://github.com/paul-hammant/tbd/edit/master/content//_index.md">Contribute to this page</a>

			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://trunkbaseddevelopment.ru/release-from-trunk/" title="Релиз из ветки trunk">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Релиз из ветки trunk
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://trunkbaseddevelopment.ru/branch-by-abstraction/" title="Ветвление по абстракции">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Ветвление по абстракции
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/trunkbaseddevelopment.ru\/';
      var repo_id  = 'paul-hammant\/tbd';
    
    </script>

    <script src="https://trunkbaseddevelopment.ru/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }

      var showHideRefs = document.getElementById("showHideRefs");
      var refsElsewhereH1;
      var refsTable;
      if (showHideRefs) {
          refsElsewhereH1 = document.getElementById("references-elsewhere");
      }
      if (showHideRefs) {
          refsTable = refsElsewhereH1.nextElementSibling.nextElementSibling;
          hideRefs();
      }

      function hideRefs() {
          refsTable.style.display = "none";
          showHideRefs.innerHTML = "show references";
      }

      function toggleRefs() {
          if(refsTable.style.display == "block") {
              hideRefs();
          }
          else {
              refsTable.style.display = "block";
              showHideRefs.innerHTML = "hide references";
          }
      }


    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-24415524-3', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

