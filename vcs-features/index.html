<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="ru-ru">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Функции системы контроля версий - Trunk Based Development</title>
    <meta name="generator" content="Hugo 0.74.3" />

    
    <meta name="description" content="A portal on this practice">
    
    <link rel="canonical" href="https://trunkbaseddevelopment.ru/vcs-features/">
    
    <meta name="author" content="paul-hammant">
    

    <meta property="og:url" content="https://trunkbaseddevelopment.ru/vcs-features/">
    <meta property="og:title" content="Trunk Based Development">
    <meta property="og:image" content="https://trunkbaseddevelopment.ru/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Trunk Based Development">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://trunkbaseddevelopment.ru/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://trunkbaseddevelopment.ru/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://trunkbaseddevelopment.ru/fonts/icon.eot');
        src: url('https://trunkbaseddevelopment.ru/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://trunkbaseddevelopment.ru/fonts/icon.woff')
               format('woff'),
             url('https://trunkbaseddevelopment.ru/fonts/icon.ttf')
               format('truetype'),
             url('https://trunkbaseddevelopment.ru/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/application.css">
    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://trunkbaseddevelopment.ru/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://trunkbaseddevelopment.ru/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-light-blue">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Trunk Based Development: Функции системы контроля версий
      </div>
    </div>

    

        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <div class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://trunkbaseddevelopment.ru/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Trunk Based Development</strong>
      </div>
    </div>
  </div>

  <div class="scrollable">
    <div class="wrapper">
      <hr>

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Введение" href="https://trunkbaseddevelopment.ru/">
	
	Введение
</a>



  
</li>



<li>
  
    



<a  title="Контекст" href="https://trunkbaseddevelopment.ru/context/">
	
	Контекст
</a>



  
</li>



<li>
  
    



<a  title="Краткий обзор" href="https://trunkbaseddevelopment.ru/5-min-overview/">
	
	Краткий обзор
</a>



  
</li>



<li>
  
    



<a  title="Определяющие факторы" href="https://trunkbaseddevelopment.ru/deciding-factors/">
	
	Определяющие факторы
</a>



  
</li>



<li>
  
    



<a class="current" title="Функции системы контроля версий" href="https://trunkbaseddevelopment.ru/vcs-features/">
	
	Функции системы контроля версий
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Version control system choices" href="https://trunkbaseddevelopment.ru/vcs-choices/">
	
	Version control system choices
</a>



  
</li>



<li>
  
    



<a  title="Флаги для функций" href="https://trunkbaseddevelopment.ru/feature-flags/">
	
	Флаги для функций
</a>



  
</li>



<li>
  
    



<a  title="Ветвление по абстракции" href="https://trunkbaseddevelopment.ru/branch-by-abstraction/">
	
	Ветвление по абстракции
</a>



  
</li>



<li>
  
    



<a  title="Ветка для релиза" href="https://trunkbaseddevelopment.ru/branch-for-release/">
	
	Ветка для релиза
</a>



  
</li>



<li>
  
    



<a  title="Релиз из ветки trunk" href="https://trunkbaseddevelopment.ru/release-from-trunk/">
	
	Релиз из ветки trunk
</a>



  
</li>



<li>
  
    



<a  title="Styles and Trade-offs" href="https://trunkbaseddevelopment.ru/styles/">
	
	Styles and Trade-offs
</a>



  
</li>



<li>
  
    



<a  title="Continuous Integration (CI)" href="https://trunkbaseddevelopment.ru/continuous-integration/">
	
	Continuous Integration (CI)
</a>



  
</li>



<li>
  
    



<a  title="Вливание кода напрямую в trunk" href="https://trunkbaseddevelopment.ru/committing-straight-to-the-trunk/">
	
	Вливание кода напрямую в trunk
</a>



  
</li>



<li>
  
    



<a  title="Short Lived Feature Branches" href="https://trunkbaseddevelopment.ru/short-lived-feature-branches/">
	
	Short Lived Feature Branches
</a>



  
</li>



<li>
  
    



<a  title="Continuous Code Review" href="https://trunkbaseddevelopment.ru/continuous-review/">
	
	Continuous Code Review
</a>



  
</li>



<li>
  
    



<a  title="Continuous Delivery (CD)" href="https://trunkbaseddevelopment.ru/continuous-delivery/">
	
	Continuous Delivery (CD)
</a>



  
</li>



<li>
  
    



<a  title="Concurrent development of consecutive releases" href="https://trunkbaseddevelopment.ru/concurrent-development-of-consecutive-releases/">
	
	Concurrent development of consecutive releases
</a>



  
</li>



<li>
  
    



<a  title="Application strangulation" href="https://trunkbaseddevelopment.ru/strangulation/">
	
	Application strangulation
</a>



  
</li>



<li>
  
    



<a  title="Observed habits" href="https://trunkbaseddevelopment.ru/observed-habits/">
	
	Observed habits
</a>



  
</li>



<li>
  
    



<a  title="You&#39;re doing it wrong" href="https://trunkbaseddevelopment.ru/youre-doing-it-wrong/">
	
	You&#39;re doing it wrong
</a>



  
</li>



<li>
  
    



<a  title="Alternative branching models" href="https://trunkbaseddevelopment.ru/alternative-branching-models/">
	
	Alternative branching models
</a>



  
</li>



<li>
  
    



<a  title="Monorepos" href="https://trunkbaseddevelopment.ru/monorepos/">
	
	Monorepos
</a>



  
</li>



<li>
  
    



<a  title="Expanding Contracting Monorepos" href="https://trunkbaseddevelopment.ru/expanding-contracting-monorepos/">
	
	Expanding Contracting Monorepos
</a>



  
</li>



<li>
  
    



<a  title="Game Changers" href="https://trunkbaseddevelopment.ru/game-changers/">
	
	Game Changers
</a>



  
</li>



<li>
  
    



<a  title="Publications" href="https://trunkbaseddevelopment.ru/publications/">
	
	Publications
</a>



  
</li>



<li>
  
    



<a  title="Book on this topic" href="https://trunkbaseddevelopment.ru/book/">
	
	Book on this topic
</a>



  
</li>



<li>
  
    



<a  title="Key to branch diagrams" href="https://trunkbaseddevelopment.ru/key/">
	
	Key to branch diagrams
</a>



  
</li>



<li>
  
    



<a  title="Contributions" href="https://trunkbaseddevelopment.ru/contributions/">
	
	Contributions
</a>



  
</li>


        </ul>
        

        
        <hr>

        <ul>

          <li>
            <a href="https://github.com/paul-hammant/tbd" target="_blank" title="See GitHub Repo">
              Site Source on Github
            </a>
          </li>

          <li>
            <a href="https://github.com/paul-hammant/tbd/commit/" target="_blank">
              SHA-1 Published: 
            </a>
          </li>
          </li>
<iframe id="buy" width='160' height='400' src='https://leanpub.com/trunk-based-development/embed' frameborder='0' allowtransparency='true'></iframe>
          <li>
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1 style="color: white; padding: 32px 20px 72px; background-image:url(/images/LogoSlim.png); background-repeat: no-repeat; background-size: 100% auto"><span style="background-color: #5677fc">Функции системы контроля версий </span></h1>

			<p><strong>Желательные функции системы контроля версий, то есть</strong></p>
<p>По большому счету, вы можете начать работать по Trunk-Based Development в любой системе контроля версий, которая позволяет делать атомарные коммиты
(спойлер: после CVS эта возможность есть во всех системах контроля версий). Хотя, их основное различие - продуктивность и то, как мы ими управляем.</p>
<h2 id="продуктивность">Продуктивность</h2>
<p>Оказывается, есть много причин, связанных с производительностью,
по которым команды меняют одну технологию на другую.
Неважно, является ли инструмент коммерческим или открытым. По крайней мере, для конечных пользователей это не так.</p>
<p>Под скоростью мы, в первую очередь, подразумеваем две вещи:</p>
<ol>
<li>Скорость, с которой мы можем подтягивать/обновлять/синхронизировать изменения на удаленном сервере.</li>
<li>Скорость, с которой мы можем фиксировать/отправлять изменения обратно на удаленный сервер.</li>
</ol>
<p>И еще три второстепенные вещи:</p>
<ol>
<li>Улучшенное слияние кода</li>
<li>Code Review</li>
<li>Continuous Integration</li>
</ol>
<h3 id="скорость-подтягиванияобновлениясинхронизации-изменений">Скорость подтягивания/обновления/синхронизации изменений</h3>
<p>Если вы переходите на какую-нибудь ветку в проекте (checkout), которую вы скачивали какое-то время назад, то в этой ветке могут появиться изменения,
которые вам надо будет подтянуть/синхронизировать с сервера, т.е. обновить текущую версию кода в этой ветке.
Если вы быстро выполните два обновления ветки подряд, то второе, скорей всего, будет бесполезным.
Время, затраченное системой контроля версий на определение того, что из удаленного главного репозитория больше ничего не нужно скачивать,
определяет то, насколько быстрой явлетяся эта система.</p>
<p>Технологии, которые хранят head revision при смене ветки и больше ничего не делают, обычно должны проходиться по всем папкам и искать изменения в файлах,
а затем проверять каждое изменение на сервере. На этой технологии построена Subversion и ее предшественник CVS.
Если мы объединим все запросы к серверу на проверку изменений в один общий запрос, то это ускорит работу, но все равно будут проседания по скорости в связи с
шириной и глубиной структуры проекта. Perforce делает операцию быстрее, потому что серверная сторона всегда готова к синхронизации,
сохраняя ваше дерево и ту ревизию, которая у вас есть для каждого файла в ОЗУ.
Это делается за счет поддержки битов, доступных только для чтения, для файлов
(обязательно используйте IDE, которая обрабатывает взаимодействия Perforce в фоновом режиме).
Perforce может быть намного быстрее в этом последовательном тесте скорости извлечения/обновления/синхронизации, потому что он уже знает ответ на вопрос
про текущий статус файла и надо ли его обновлять.</p>
<p>CVS, Subversion and Perforce предлагают вам выбрать проверяемый подкаталог. В ситуации с монорепозиторием вам это очень хорошо подошло бы.
По крайней мере, если бы вы рекурсивно разместили службы и приложения внутри trunk.</p>
<p>Git и Mercurial имеют единую точку получения (операция «клонирования» в Git) для всего репозитория.
Также в этих двух системах контроля версий нет проверки поддиректорий. Все коммиты с момента последнего обновления репозитория будут скачаны.
Это происходит до обхода каталога для определения того, что изменилось локально.
Таким образом, эта операция извлечения выполняется очень быстро - все даныне уже получены, а содержимое на стороне сервера уже заархивировано и в значительной степени готово к скачиванию.
Это будет иметь место даже в тех случаях, когда конкретный файл был изменен десятки раз с тех пор, как вы в последний раз скачали его его с помощью операции синхронизации. Вы можете подумать, что это долго, но на практике Git невероятно быстр.</p>
<h3 id="скорость-коммитов-и-отправки-кода-на-сервер">Скорость коммитов и отправки кода на сервер</h3>
<p>У инструментов, которые мы считаем пригодными для работы, более-менее равные возможности в плане скорости коммитов и отправки кода на сервер.</p>
<p>Subversion и Perforce отправляют на сервер разницу в измененных файлах. Некоторые действия, например обход каталога, могут замедлить эту операцию.
Для этих операций мы не сможем избежать большого количества сетевых запросов.</p>
<p>Git и Mercurial делают то же самое, но до того, как вы отправите свой код в удаленное хранилище (push), вы зафиксируете код локально (commit) - это невероятно
быстро. Прежде чем вы отправите сообщение в общее удаленное хранилище, Git и Mercurial сначала предложат вам подтянуть изменения с сервера (pull).</p>
<p>Perforce и Subversion позволят вам фиксировать/отправлять изменения в удаленный репозиторий без локального скачивания последней версии кода (и,
кстати, всех промежуточных тоже). Это допустимо только в том случае, если между строками кода, которые вы правили,
и актуальной версией кода на сервере нет никакх конфликтов.</p>
<p>Perforce, кстати, действует немного хитро - он использует преимущество &ldquo;read-only&rdquo; бита и, следовательно, уже знает, какие файлы определенно
<strong>не</strong> изменились между удаленным хранилищем и локальной рабочей копией кода. Однако он все еще кажется медленнее, чем должен быть.</p>
<h3 id="three-way-merge-tools">Three-way merge tools</h3>
<p>Если у разработчиков (надеюсь, что они программируют в парах) есть незавершенная работа в их рабочей копии кода, то им нужно будет научиться:</p>
<ol>
<li>Арбитражу при слиянии для кода, который они хотят отправить в trunk на удаленном сервере.</li>
<li>Арбитражу при получении изменений, которые они получают из trunk на удаленном сервере.
Как видите, команды разработчиков на основе Trunk-Based Development взаимодействуют все чаще.
Хотя это небольшие слияния, и они неявно сливаются с вашей рабочей копией.</li>
</ol>
<p>Инструмент трехстороннего слияния Perforce (P4Merge) сам по себе достаточно хорош, чтобы быть привлекательным для команд, использующих другие технологии VCS.
Для других технологий P4Merge - это просто настройка конфигурации, которую нельзя использовать.</p>
<p>Семантическое слияние - это следующий шаг в науке об управлении версиями. См. <a href="https://trunkbaseddevelopment.ru/vcs-choices/index.html#plasticscm">Plastic SCM</a>.</p>
<h3 id="code-review">Code Review</h3>
<p>Интегрированный обзор кода оказался важнейшей функцией в системах контроля версий. Это должно было быть ясно с того момента, как Mondrian
был представлен Гвидо ван Россумом (мистер Python) в <a href="https://www.youtube.com/watch?v=sMql3Di4Kgc">разрекламированном Google &lsquo;техническом разговоре&rsquo; в 2006</a>.
У Mondrian есть такая функция, как code review перед отправкой кода, и в какой-то степени это стало похоже на игру.
Раньше Google использовал Perforce (они перешли на технологию, которая была разработана внутри компании, в 2012 году), и у него не было встроенного инструмента для
code review, так что Google пришлось перейти на Mondrian, который был окончательный результатом нескольких лет разработки.
Создаваемый Mondrian тесно увязал анализ кода с почасовой деятельностью разработчиков в trunk.</p>
<p>GitHub (не Git) был следующим инструментом для мира разработчиков, который не был связан с Google, со встроенным инструментом проверки кода (и рабочим процессом).
Опять же это было эффективно выполнить предварительный commit - или, по крайней мере, сделать commit в master ветке.</p>
<p>Были (и есть) другие технологии для code review, такие как Crucible (Atlassian), UpSource (JetBrains), Gerrit,
Phabricator, но ключевым моментом является интеграция в платформу. GitLab и RhodeCode - развивающиеся платформы.</p>
<p>Можете почитать <a href="https://trunkbaseddevelopment.ru/game-changers/index.html#google-s-internal-devops-2006-onwards">Game Changers - Google&rsquo;s Mondrian</a> и
<a href="https://trunkbaseddevelopment.ru/game-changers/index.html#github-s-entire-platform-2008-onwards">Game Changers - GitHub&rsquo;s Pull Requests</a>.</p>
<h3 id="continuous-integration-тестирование">Continuous Integration тестирование</h3>
<p>Это идет рука об руку с возможностью code review. Серверы CI запускаются для кода, который был отправлен в ветку для code review,
а потом для кода, который был отправлен в ветку в процессе code review, и проверяют изменения. Обычная сборка (а может и некоторые
дополнительные шаги, которые выполняются после сборки и выдают результат тем, кто смотрит код) в Facebook имеет
Соглашение об уровне обслуживания, согласно которому тестирование кода должно быть выполнено в течение десять минут после того, как код был помещен в очередь «требуется проверка кода».</p>
<p>Реальность платформ VCS сегодня такова, что они предоставляли hooks (скорее всего, webhooks) только для других серверов CI. Лучшие комбинации системы контроля версий и сервера CI делают это для любой из задействованных веток, включая ветки проверки кода(forks).</p>
<h2 id="управление">Управление</h2>
<p>Оказывается, предприятиям нравится возможность разделять разрешения и устанавливать разрешения на чтение и запись во всех своих репозиториях.</p>
<h3 id="детализированные-разрешения">Детализированные разрешения</h3>
<p>Все виды систем контроля версий требуют наличие учетной записи у пользователей для того, чтобы иметь возможность откатить изменения обратно,
но при этом не все они требуют учетную запись для того, чтобы иметь возможность смотреть код (права на чтение).
В корпоративных учетных записях пользователей также требуется иметь права на чтение.</p>
<p>Чем крупнее предприятие, тем больше вероятность того, что у них будут более мелкие разрешения.
Например, разрешение «можно отправить commit в trunk, но нельзя создавать ветку версии», очень часто встречается в корпорациях, где команды работают по
Trunk-Based Development и работают с релизными ветками. Не все системы контроля версий поддерживают это.
Git, например, эту функцию не поддерживает, но есть разные экспериментальные решения на базе git, в которых эта функция добавлена.
Однако, в действительности вы не можете помешать людям создавать ветки в распределенной системе контроля версий,
но вы можете запретить им отправлять эти ветки в общий репозиторий.</p>
<p>Более того, некоторые предприятия захотят установить разрешения на уровне каталогов внутри ветки в репозитории.
Это может быть так же просто, как шлюз, чтобы гарантировать, что процесс соблюдается при проверке, но также может быть и для защиты
некоторые секреты реализации Monorepo. Последнее противоречит некоторым идеалам &ldquo;общего владения кодом&rdquo;
современная программная инженерия.</p>
<p>Deeper still, some enterprises will want to set permissions down the directory level within a branch within a repository.
This could be as simple as a gate, to ensure that process is adhered to around checkins, but could also be to guard
some secrets in a Monorepo implementation. That last is counter to some of the &ldquo;common code ownership&rdquo; ideals of
modern software engineering though.</p>
<h3 id="size--scale">Size / Scale</h3>
<p>Many teams, particularly those with Monorepo configurations or large binary files (like Games companies), want to have
limitless server-side storage for their repository.  Git and Mercurial are inching towards bigger and bigger
capacity, but there are still a few snafus to work through - how to cleanly/safely reduce the size of the client side clone
history (while still being able to push changes back to the server) is a challenge.</p>
<p>Microsoft released Git Virtual File System (<del>GitVFS</del> <del>GVFS</del> VFS for Git<span class="rref"><a class="inline-ref" style="border-bottom: 0" target="_blank" href="https://vfsforgit.org/"><img style="padding: 0 0 0 3px; width: 16px; height: 14px" src="https://trunkbaseddevelopment.ru/images/ext.png" alt=""></a></span>) in early 2017, to layer on some of the things they had
become used to in the in-house recompilation of Perforce (SourceDepot - used from 1998 to 201x), as well as native VCS
of their commercial offering Team Foundation Server (TFS).</p>


			<aside class="copyright" role="note">
				&copy; 2017-2020: <a href="https://devops.paulhammant.com/">Paul Hammant</a>. With Contributions <a href="https://trunkbaseddevelopment.ru/contributions/">from friends</a>.
				Site built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				with
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme,
				via <a href="https://netlify.com/">Netlify</a>. &nbsp;
				<a href="https://github.com/paul-hammant/tbd/edit/master/content//_index.md">Contribute to this page</a>

			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://trunkbaseddevelopment.ru/vcs-choices/" title="Version control system choices">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Version control system choices
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://trunkbaseddevelopment.ru/deciding-factors/" title="Определяющие факторы">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Определяющие факторы
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/trunkbaseddevelopment.ru\/';
      var repo_id  = 'paul-hammant\/tbd';
    
    </script>

    <script src="https://trunkbaseddevelopment.ru/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }

      var showHideRefs = document.getElementById("showHideRefs");
      var refsElsewhereH1;
      var refsTable;
      if (showHideRefs) {
          refsElsewhereH1 = document.getElementById("references-elsewhere");
      }
      if (showHideRefs) {
          refsTable = refsElsewhereH1.nextElementSibling.nextElementSibling;
          hideRefs();
      }

      function hideRefs() {
          refsTable.style.display = "none";
          showHideRefs.innerHTML = "show references";
      }

      function toggleRefs() {
          if(refsTable.style.display == "block") {
              hideRefs();
          }
          else {
              refsTable.style.display = "block";
              showHideRefs.innerHTML = "hide references";
          }
      }


    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-24415524-3', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

